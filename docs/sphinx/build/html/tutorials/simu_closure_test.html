

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SIMUnet closure test &#8212; SIMUnet  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorials/simu_closure_test';</script>
    <script src="../_static/theme_logo_switcher.js"></script>
    <script src="../_static/no_sidebar_overlap.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Dataset selection" href="../datasets.html" />
    <link rel="prev" title="Contaminated fits" href="contaminated_fit.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/PBSP_white_line.png" class="logo__image only-light" alt="SIMUnet  documentation - Home"/>
    <script>document.write(`<img src="../_static/PBSP_white_line.png" class="logo__image only-dark" alt="SIMUnet  documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../methodology.html"><strong>Methodology</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../features.html"><strong>Features</strong></a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="tutorials_overview.html"><strong>Tutorials</strong></a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Installation.html">SIMUnet installation guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="simu_fit.html">Simultaneous fits</a></li>
<li class="toctree-l2"><a class="reference internal" href="contaminated_fit.html">Contaminated fits</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">SIMUnet closure test</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../datasets.html"><strong>Dataset selection</strong></a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../results/overview.html"><strong>Results</strong></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../results/drellyan.html">The Drell-Yan sector</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../results/top.html">The Top Sector</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../results/top_sm.html">SM PDF fits</a></li>
<li class="toctree-l3"><a class="reference internal" href="../results/top_smeft.html">SMEFT-only fit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../results/top_simultaneous.html">Simultaneous SMEFT and PDF fits</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../simunet_analysis.html"><strong>Functions documentation</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html"><strong>Bibliography</strong></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/tutorials/simu_closure_test.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>SIMUnet closure test</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="section" id="simunet-closure-test">
<span id="simu-closure-test"></span><h1>SIMUnet closure test<a class="headerlink" href="#simunet-closure-test" title="Permalink to this heading">#</a></h1>
<p>Closure tests serve as a mechanism to assess the reliability of fits of PDFs and physical parameters in general, and the robustness of the methodologies involved.</p>
<p>The <span class="math notranslate nohighlight">\(\text{SIMUnet}\)</span> code extends the capacity of the NNPDF closure test to run contaminated fits and closure tests probing the fit quality of both PDFs and
physical parameters.</p>
<p><span class="math notranslate nohighlight">\(\text{SIMUnet}\)</span> can produce BSM contaminated fits by injecting New Physics into the generated pseudodata
while the fit is done assuming the Standard Model. With this functionality, any user
can test the robustness of any New Physics scenario against being fitted away in a PDF fit.
In this context, <span class="math notranslate nohighlight">\(\text{SIMUnet}\)</span> can perform closure tests for both PDFs and physical parameters, giving surety of the reliability of the <span class="math notranslate nohighlight">\(\text{SIMUnet}\)</span>
methodology.</p>
<p>A <span class="math notranslate nohighlight">\(\text{SIMUnet}\)</span> closure test corresponds to running a BSM contaminated PDF fit and a simultaneous PDF-EFT fit at the same time.
For details about each process see each tutorial. Here is an example runcard:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Runcard for contaminated PDF fit with SIMUnet</span>
<span class="c1">#</span>
<span class="c1">############################################################</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Runcard</span><span class="nv"> </span><span class="s">template</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">contaminated</span><span class="nv"> </span><span class="s">PDF</span><span class="nv"> </span><span class="s">fit</span><span class="nv"> </span><span class="s">with</span><span class="nv"> </span><span class="s">BSM</span><span class="nv"> </span><span class="s">physics</span><span class="nv"> </span><span class="s">injected</span><span class="nv"> </span><span class="s">in</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">data,</span>
<span class="s">defined</span><span class="nv"> </span><span class="s">as</span><span class="nv"> </span><span class="s">linear</span><span class="nv"> </span><span class="s">combinations</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">SMEFT</span><span class="nv"> </span><span class="s">Warsaw</span><span class="nv"> </span><span class="s">basis</span><span class="nv"> </span><span class="s">operators.&quot;</span>

<span class="c1">############################################################</span>
<span class="c1"># frac: training fraction of datapoints for the PDFs</span>
<span class="c1"># QCD: apply QCD K-factors</span>
<span class="c1"># EWK: apply electroweak K-factors</span>
<span class="c1"># simu_fac: fit BSM coefficients using their K-factors in the dataset</span>
<span class="c1"># use_fixed_predictions:  if set to True it removes the PDF dependence of the dataset</span>
<span class="c1"># sys: systematics treatment (see systypes)</span>

<span class="c1">############################################################</span>
<span class="nt">dataset_inputs</span><span class="p">:</span>

<span class="c1">### &#39;Standard&#39; datasets ###</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">NMCPD_dw_ite</span><span class="p p-Indicator">,</span><span class="nt"> frac</span><span class="p">:</span><span class="w"> </span><span class="nv">0.75</span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">NMC</span><span class="p p-Indicator">,</span><span class="nt"> frac</span><span class="p">:</span><span class="w"> </span><span class="nv">0.75</span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">SLACP_dwsh</span><span class="p p-Indicator">,</span><span class="nt"> frac</span><span class="p">:</span><span class="w"> </span><span class="nv">0.75</span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">HERACOMBCCEP</span><span class="p p-Indicator">,</span><span class="nt"> frac</span><span class="p">:</span><span class="w"> </span><span class="nv">0.75</span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">HERACOMB_SIGMARED_C</span><span class="p p-Indicator">,</span><span class="nt"> frac</span><span class="p">:</span><span class="w"> </span><span class="nv">0.75</span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">HERACOMB_SIGMARED_B</span><span class="p p-Indicator">,</span><span class="nt"> frac</span><span class="p">:</span><span class="w"> </span><span class="nv">0.75</span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">DYE886R_dw_ite</span><span class="p p-Indicator">,</span><span class="nt"> frac</span><span class="p">:</span><span class="w"> </span><span class="nv">0.75</span><span class="p p-Indicator">,</span><span class="nt"> cfac</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;QCD&#39;</span><span class="p p-Indicator">]}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">DYE886P</span><span class="p p-Indicator">,</span><span class="nt"> frac</span><span class="p">:</span><span class="w"> </span><span class="nv">0.75</span><span class="p p-Indicator">,</span><span class="nt"> cfac</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;QCD&#39;</span><span class="p p-Indicator">]}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">DYE605_dw_ite</span><span class="p p-Indicator">,</span><span class="nt"> frac</span><span class="p">:</span><span class="w"> </span><span class="nv">0.75</span><span class="p p-Indicator">,</span><span class="nt"> cfac</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;QCD&#39;</span><span class="p p-Indicator">]}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">DYE906R_dw_ite</span><span class="p p-Indicator">,</span><span class="nt"> frac</span><span class="p">:</span><span class="w"> </span><span class="nv">0.75</span><span class="p p-Indicator">,</span><span class="nt"> cfac</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;ACC&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;QCD&#39;</span><span class="p p-Indicator">]}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">CDFZRAP_NEW</span><span class="p p-Indicator">,</span><span class="nt"> frac</span><span class="p">:</span><span class="w"> </span><span class="nv">0.75</span><span class="p p-Indicator">,</span><span class="nt"> cfac</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;QCD&#39;</span><span class="p p-Indicator">]}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">D0ZRAP_40</span><span class="p p-Indicator">,</span><span class="nt"> frac</span><span class="p">:</span><span class="w"> </span><span class="nv">0.75</span><span class="p p-Indicator">,</span><span class="nt"> cfac</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;QCD&#39;</span><span class="p p-Indicator">]}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">D0WMASY</span><span class="p p-Indicator">,</span><span class="nt"> frac</span><span class="p">:</span><span class="w"> </span><span class="nv">0.75</span><span class="p p-Indicator">,</span><span class="nt"> cfac</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;QCD&#39;</span><span class="p p-Indicator">]}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">ATLASWZRAP36PB</span><span class="p p-Indicator">,</span><span class="nt"> frac</span><span class="p">:</span><span class="w"> </span><span class="nv">0.75</span><span class="p p-Indicator">,</span><span class="nt"> cfac</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;QCD&#39;</span><span class="p p-Indicator">]}</span>

<span class="c1">### &#39;Contaminated&#39; datasets ###</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">CMSDY1D12</span><span class="p p-Indicator">,</span><span class="nt"> frac</span><span class="p">:</span><span class="w"> </span><span class="nv">0.75</span><span class="p p-Indicator">,</span><span class="nt"> cfac</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;QCD&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;EWK&#39;</span><span class="p p-Indicator">],</span><span class="nt"> contamination</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;EFT_LO&#39;</span><span class="p p-Indicator">,</span><span class="nt"> simu_fac</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;EFT_LO&quot;</span><span class="p p-Indicator">,}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">CMS_HMDY_13TEV</span><span class="p p-Indicator">,</span><span class="nt"> frac</span><span class="p">:</span><span class="w"> </span><span class="nv">0.75</span><span class="p p-Indicator">,</span><span class="nt"> cfac</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;QCD&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;EWK&#39;</span><span class="p p-Indicator">],</span><span class="nt"> contamination</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;EFT_LO&#39;</span><span class="p p-Indicator">,</span><span class="nt"> simu_fac</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;EFT_LO&quot;</span><span class="p p-Indicator">,}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">ATLASDY2D8TEV</span><span class="p p-Indicator">,</span><span class="nt"> frac</span><span class="p">:</span><span class="w"> </span><span class="nv">0.75</span><span class="p p-Indicator">,</span><span class="nt"> cfac</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;QCDEWK&#39;</span><span class="p p-Indicator">],</span><span class="nt"> contamination</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;EFT_LO&#39;</span><span class="p p-Indicator">,</span><span class="nt"> simu_fac</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;EFT_LO&quot;</span><span class="p p-Indicator">,}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">ATLASZHIGHMASS49FB</span><span class="p p-Indicator">,</span><span class="nt"> frac</span><span class="p">:</span><span class="w"> </span><span class="nv">0.75</span><span class="p p-Indicator">,</span><span class="nt"> cfac</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;QCD&#39;</span><span class="p p-Indicator">],</span><span class="nt"> contamination</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;EFT_LO&#39;</span><span class="p p-Indicator">,</span><span class="nt"> simu_fac</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;EFT_LO&quot;</span><span class="p p-Indicator">,}</span>

<span class="nt">fixed_pdf_fit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
<span class="c1"># load_weights_from_fit: 221103-jmm-no_top_1000_iterated # If this is uncommented, training starts here.</span>

<span class="nt">simu_parameters</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Olq3&#39;</span><span class="p p-Indicator">,</span><span class="nt"> scale</span><span class="p">:</span><span class="w"> </span><span class="nv">10</span><span class="p p-Indicator">,</span><span class="nt"> initialisation</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="nv">uniform</span><span class="p p-Indicator">,</span><span class="nt"> minval</span><span class="p">:</span><span class="w"> </span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="nt"> maxval</span><span class="p">:</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">}}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;OtG&#39;</span><span class="p p-Indicator">,</span><span class="nt"> scale</span><span class="p">:</span><span class="w"> </span><span class="nv">0.1</span><span class="p p-Indicator">,</span><span class="nt"> initialisation</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="nv">uniform</span><span class="p p-Indicator">,</span><span class="nt"> minval</span><span class="p">:</span><span class="w"> </span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="nt"> maxval</span><span class="p">:</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">}}</span>

<span class="c1">###########################################################</span>
<span class="c1"># The closure test namespace tells us the settings for the</span>
<span class="c1"># (possible contaminated) closure test.</span>
<span class="c1">############################################################</span>
<span class="nt">closuretest</span><span class="p">:</span>
<span class="nt">filterseed</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span><span class="w"> </span><span class="c1"># Random seed to be used in filtering data partitions</span>
<span class="nt">fakedata</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w">     </span><span class="c1"># true = to use FAKEPDF to generate pseudo-data</span>
<span class="nt">fakepdf</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NNPDF40_nnlo_as_01180</span><span class="w">      </span><span class="c1"># Theory input for pseudo-data</span>
<span class="nt">errorsize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span><span class="w">    </span><span class="c1"># uncertainties rescaling</span>
<span class="nt">fakenoise</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w">    </span><span class="c1"># true = to add random fluctuations to pseudo-data</span>
<span class="nt">rancutprob</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span><span class="w">   </span><span class="c1"># Fraction of data to be included in the fit</span>
<span class="nt">rancutmethod</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span><span class="w">   </span><span class="c1"># Method to select rancutprob data fraction</span>
<span class="nt">rancuttrnval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"> </span><span class="c1"># 0(1) to output training(valiation) chi2 in report</span>
<span class="nt">printpdf4gen</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"> </span><span class="c1"># To print info on PDFs during minimization</span>
<span class="nt">contamination_parameters</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;W&#39;</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.00008</span>
<span class="w">    </span><span class="nt">linear_combination</span><span class="p">:</span>
<span class="w">        </span><span class="s">&#39;Olq3&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-15.94</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Y&#39;</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">linear_combination</span><span class="p">:</span>
<span class="w">        </span><span class="s">&#39;Olq1&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.51606</span>
<span class="w">        </span><span class="s">&#39;Oed&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-6.0606</span>
<span class="w">        </span><span class="s">&#39;Oeu&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">12.1394</span>
<span class="w">        </span><span class="s">&#39;Olu&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">6.0606</span>
<span class="w">        </span><span class="s">&#39;Old&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-3.0394</span>
<span class="w">        </span><span class="s">&#39;Oqe&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3.0394</span>

<span class="nt">seed</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="nt">rngalgo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="c1">############################################################</span>
<span class="nt">datacuts</span><span class="p">:</span>
<span class="nt">t0pdfset</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NNPDF40_nnlo_as_01180</span><span class="w"> </span><span class="c1"># PDF set to generate t0 covmat</span>
<span class="nt">q2min</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3.49</span><span class="w">                        </span><span class="c1"># Q2 minimum</span>
<span class="nt">w2min</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">12.5</span><span class="w">                        </span><span class="c1"># W2 minimum</span>

<span class="c1">############################################################</span>
<span class="nt">theory</span><span class="p">:</span>
<span class="nt">theoryid</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">200</span><span class="w">     </span><span class="c1"># database id</span>

<span class="c1">############################################################</span>
<span class="nt">trvlseed</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">475038818</span>
<span class="nt">nnseed</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2394641471</span>
<span class="nt">mcseed</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1831662593</span>
<span class="nt">save</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;weights.h5&quot;</span>
<span class="nt">genrep</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w">      </span><span class="c1"># true = generate MC replicas, false = use real data</span>

<span class="c1">############################################################</span>


<span class="nt">parameters</span><span class="p">:</span><span class="w"> </span><span class="c1"># This defines the parameter dictionary that is passed to the Model Trainer</span>
<span class="nt">nodes_per_layer</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">25</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">20</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">8</span><span class="p p-Indicator">]</span>
<span class="nt">activation_per_layer</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">tanh</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">tanh</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">linear</span><span class="p p-Indicator">]</span>
<span class="nt">initializer</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">glorot_normal</span>
<span class="nt">optimizer</span><span class="p">:</span>
<span class="w">    </span><span class="nt">clipnorm</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">6.073e-6</span>
<span class="w">    </span><span class="nt">learning_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2.621e-3</span>
<span class="w">    </span><span class="nt">optimizer_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Nadam</span>
<span class="nt">epochs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30000</span>
<span class="nt">positivity</span><span class="p">:</span>
<span class="w">    </span><span class="nt">initial</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">184.8</span>
<span class="w">    </span><span class="nt">multiplier</span><span class="p">:</span>
<span class="nt">integrability</span><span class="p">:</span>
<span class="w">    </span><span class="nt">initial</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">184.8</span>
<span class="w">    </span><span class="nt">multiplier</span><span class="p">:</span>
<span class="nt">stopping_patience</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.2</span>
<span class="nt">layer_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dense</span>
<span class="nt">dropout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0</span>
<span class="nt">threshold_chi2</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3.5</span>

<span class="nt">fitting</span><span class="p">:</span>
<span class="c1"># EVOL(QED) = sng=0,g=1,v=2,v3=3,v8=4,t3=5,t8=6,(pht=7)</span>
<span class="c1"># EVOLS(QED)= sng=0,g=1,v=2,v8=4,t3=4,t8=5,ds=6,(pht=7)</span>
<span class="c1"># FLVR(QED) = g=0, u=1, ubar=2, d=3, dbar=4, s=5, sbar=6, (pht=7)</span>
<span class="nt">fitbasis</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">EVOL</span><span class="w">  </span><span class="c1"># EVOL (7), EVOLQED (8), etc.</span>
<span class="nt">basis</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">fl</span><span class="p">:</span><span class="w"> </span><span class="nv">sng</span><span class="p p-Indicator">,</span><span class="nt"> pos</span><span class="p">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span><span class="nt"> trainable</span><span class="p">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span><span class="nt"> mutsize</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">15</span><span class="p p-Indicator">],</span><span class="nt"> mutprob</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0.05</span><span class="p p-Indicator">],</span><span class="nt"> smallx</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
<span class="w">    </span><span class="nv">1.093</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1.121</span><span class="p p-Indicator">],</span><span class="nt"> largex</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1.486</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3.287</span><span class="p p-Indicator">]}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">fl</span><span class="p">:</span><span class="w"> </span><span class="nv">g</span><span class="p p-Indicator">,</span><span class="nt"> pos</span><span class="p">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span><span class="nt"> trainable</span><span class="p">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span><span class="nt"> mutsize</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">15</span><span class="p p-Indicator">],</span><span class="nt"> mutprob</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0.05</span><span class="p p-Indicator">],</span><span class="nt"> smallx</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
<span class="w">    </span><span class="nv">0.8329</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1.071</span><span class="p p-Indicator">],</span><span class="nt"> largex</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">3.084</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">6.767</span><span class="p p-Indicator">]}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">fl</span><span class="p">:</span><span class="w"> </span><span class="nv">v</span><span class="p p-Indicator">,</span><span class="nt"> pos</span><span class="p">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span><span class="nt"> trainable</span><span class="p">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span><span class="nt"> mutsize</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">15</span><span class="p p-Indicator">],</span><span class="nt"> mutprob</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0.05</span><span class="p p-Indicator">],</span><span class="nt"> smallx</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
<span class="w">    </span><span class="nv">0.5202</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">0.7431</span><span class="p p-Indicator">],</span><span class="nt"> largex</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1.556</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3.639</span><span class="p p-Indicator">]}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">fl</span><span class="p">:</span><span class="w"> </span><span class="nv">v3</span><span class="p p-Indicator">,</span><span class="nt"> pos</span><span class="p">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span><span class="nt"> trainable</span><span class="p">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span><span class="nt"> mutsize</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">15</span><span class="p p-Indicator">],</span><span class="nt"> mutprob</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0.05</span><span class="p p-Indicator">],</span><span class="nt"> smallx</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
<span class="w">    </span><span class="nv">0.1205</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">0.4839</span><span class="p p-Indicator">],</span><span class="nt"> largex</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1.736</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3.622</span><span class="p p-Indicator">]}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">fl</span><span class="p">:</span><span class="w"> </span><span class="nv">v8</span><span class="p p-Indicator">,</span><span class="nt"> pos</span><span class="p">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span><span class="nt"> trainable</span><span class="p">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span><span class="nt"> mutsize</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">15</span><span class="p p-Indicator">],</span><span class="nt"> mutprob</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0.05</span><span class="p p-Indicator">],</span><span class="nt"> smallx</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
<span class="w">    </span><span class="nv">0.5864</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">0.7987</span><span class="p p-Indicator">],</span><span class="nt"> largex</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1.559</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3.569</span><span class="p p-Indicator">]}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">fl</span><span class="p">:</span><span class="w"> </span><span class="nv">t3</span><span class="p p-Indicator">,</span><span class="nt"> pos</span><span class="p">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span><span class="nt"> trainable</span><span class="p">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span><span class="nt"> mutsize</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">15</span><span class="p p-Indicator">],</span><span class="nt"> mutprob</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0.05</span><span class="p p-Indicator">],</span><span class="nt"> smallx</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
<span class="w">    </span><span class="nv">-0.5019</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1.126</span><span class="p p-Indicator">],</span><span class="nt"> largex</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1.754</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3.479</span><span class="p p-Indicator">]}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">fl</span><span class="p">:</span><span class="w"> </span><span class="nv">t8</span><span class="p p-Indicator">,</span><span class="nt"> pos</span><span class="p">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span><span class="nt"> trainable</span><span class="p">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span><span class="nt"> mutsize</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">15</span><span class="p p-Indicator">],</span><span class="nt"> mutprob</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0.05</span><span class="p p-Indicator">],</span><span class="nt"> smallx</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
<span class="w">    </span><span class="nv">0.6305</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">0.8806</span><span class="p p-Indicator">],</span><span class="nt"> largex</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1.544</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3.481</span><span class="p p-Indicator">]}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">fl</span><span class="p">:</span><span class="w"> </span><span class="nv">t15</span><span class="p p-Indicator">,</span><span class="nt"> pos</span><span class="p">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span><span class="nt"> trainable</span><span class="p">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span><span class="nt"> mutsize</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">15</span><span class="p p-Indicator">],</span><span class="nt"> mutprob</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0.05</span><span class="p p-Indicator">],</span><span class="nt"> smallx</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
<span class="w">    </span><span class="nv">1.087</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1.139</span><span class="p p-Indicator">],</span><span class="nt"> largex</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1.48</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3.365</span><span class="p p-Indicator">]}</span>

<span class="c1">############################################################</span>
<span class="nt">positivity</span><span class="p">:</span>
<span class="nt">posdatasets</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">POSF2U</span><span class="p p-Indicator">,</span><span class="nt"> maxlambda</span><span class="p">:</span><span class="w"> </span><span class="nv">1e6</span><span class="p p-Indicator">}</span><span class="w">        </span><span class="c1"># Positivity Lagrange Multiplier</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">POSF2DW</span><span class="p p-Indicator">,</span><span class="nt"> maxlambda</span><span class="p">:</span><span class="w"> </span><span class="nv">1e6</span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">POSF2S</span><span class="p p-Indicator">,</span><span class="nt"> maxlambda</span><span class="p">:</span><span class="w"> </span><span class="nv">1e6</span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">POSFLL</span><span class="p p-Indicator">,</span><span class="nt"> maxlambda</span><span class="p">:</span><span class="w"> </span><span class="nv">1e6</span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">POSDYU</span><span class="p p-Indicator">,</span><span class="nt"> maxlambda</span><span class="p">:</span><span class="w"> </span><span class="nv">1e10</span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">POSDYD</span><span class="p p-Indicator">,</span><span class="nt"> maxlambda</span><span class="p">:</span><span class="w"> </span><span class="nv">1e10</span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">POSDYS</span><span class="p p-Indicator">,</span><span class="nt"> maxlambda</span><span class="p">:</span><span class="w"> </span><span class="nv">1e10</span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">POSF2C</span><span class="p p-Indicator">,</span><span class="nt"> maxlambda</span><span class="p">:</span><span class="w"> </span><span class="nv">1e6</span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">POSXUQ</span><span class="p p-Indicator">,</span><span class="nt"> maxlambda</span><span class="p">:</span><span class="w"> </span><span class="nv">1e6</span><span class="p p-Indicator">}</span><span class="w">        </span><span class="c1"># Positivity of MSbar PDFs</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">POSXUB</span><span class="p p-Indicator">,</span><span class="nt"> maxlambda</span><span class="p">:</span><span class="w"> </span><span class="nv">1e6</span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">POSXDQ</span><span class="p p-Indicator">,</span><span class="nt"> maxlambda</span><span class="p">:</span><span class="w"> </span><span class="nv">1e6</span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">POSXDB</span><span class="p p-Indicator">,</span><span class="nt"> maxlambda</span><span class="p">:</span><span class="w"> </span><span class="nv">1e6</span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">POSXSQ</span><span class="p p-Indicator">,</span><span class="nt"> maxlambda</span><span class="p">:</span><span class="w"> </span><span class="nv">1e6</span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">POSXSB</span><span class="p p-Indicator">,</span><span class="nt"> maxlambda</span><span class="p">:</span><span class="w"> </span><span class="nv">1e6</span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">POSXGL</span><span class="p p-Indicator">,</span><span class="nt"> maxlambda</span><span class="p">:</span><span class="w"> </span><span class="nv">1e6</span><span class="p p-Indicator">}</span>

<span class="c1">############################################################</span>
<span class="nt">integrability</span><span class="p">:</span>
<span class="nt">integdatasets</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">INTEGXT8</span><span class="p p-Indicator">,</span><span class="nt"> maxlambda</span><span class="p">:</span><span class="w"> </span><span class="nv">1e2</span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">INTEGXT3</span><span class="p p-Indicator">,</span><span class="nt"> maxlambda</span><span class="p">:</span><span class="w"> </span><span class="nv">1e2</span><span class="p p-Indicator">}</span>

<span class="c1">############################################################</span>
<span class="nt">debug</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">maxcores</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
</pre></div>
</div>
<p>The following section implement the BSM contamination of the data:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="c1">###########################################################</span>
<span class="c1"># The closure test namespace tells us the settings for the</span>
<span class="c1"># (possible contaminated) closure test.</span>
<span class="c1">############################################################</span>
<span class="nt">closuretest</span><span class="p">:</span>
<span class="nt">filterseed</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span><span class="w"> </span><span class="c1"># Random seed to be used in filtering data partitions</span>
<span class="nt">fakedata</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w">     </span><span class="c1"># true = to use FAKEPDF to generate pseudo-data</span>
<span class="nt">fakepdf</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NNPDF40_nnlo_as_01180</span><span class="w">      </span><span class="c1"># Theory input for pseudo-data</span>
<span class="nt">errorsize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span><span class="w">    </span><span class="c1"># uncertainties rescaling</span>
<span class="nt">fakenoise</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w">    </span><span class="c1"># true = to add random fluctuations to pseudo-data</span>
<span class="nt">rancutprob</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span><span class="w">   </span><span class="c1"># Fraction of data to be included in the fit</span>
<span class="nt">rancutmethod</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span><span class="w">   </span><span class="c1"># Method to select rancutprob data fraction</span>
<span class="nt">rancuttrnval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"> </span><span class="c1"># 0(1) to output training(valiation) chi2 in report</span>
<span class="nt">printpdf4gen</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"> </span><span class="c1"># To print info on PDFs during minimization</span>
<span class="nt">contamination_parameters</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;W&#39;</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.00008</span>
<span class="w">    </span><span class="nt">linear_combination</span><span class="p">:</span>
<span class="w">        </span><span class="s">&#39;Olq3&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-15.94</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Y&#39;</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">linear_combination</span><span class="p">:</span>
<span class="w">        </span><span class="s">&#39;Olq1&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.51606</span>
<span class="w">        </span><span class="s">&#39;Oed&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-6.0606</span>
<span class="w">        </span><span class="s">&#39;Oeu&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">12.1394</span>
<span class="w">        </span><span class="s">&#39;Olu&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">6.0606</span>
<span class="w">        </span><span class="s">&#39;Old&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-3.0394</span>
<span class="w">        </span><span class="s">&#39;Oqe&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3.0394</span>

<span class="nt">seed</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="nt">rngalgo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="c1">############################################################</span>
</pre></div>
</div>
<p>The following section implement the SMEFT Wilson coefficient fit:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="nt">simu_parameters</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Olq3&#39;</span><span class="p p-Indicator">,</span><span class="nt"> scale</span><span class="p">:</span><span class="w"> </span><span class="nv">10</span><span class="p p-Indicator">,</span><span class="nt"> initialisation</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="nv">uniform</span><span class="p p-Indicator">,</span><span class="nt"> minval</span><span class="p">:</span><span class="w"> </span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="nt"> maxval</span><span class="p">:</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">}}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;OtG&#39;</span><span class="p p-Indicator">,</span><span class="nt"> scale</span><span class="p">:</span><span class="w"> </span><span class="nv">0.1</span><span class="p p-Indicator">,</span><span class="nt"> initialisation</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="nv">uniform</span><span class="p p-Indicator">,</span><span class="nt"> minval</span><span class="p">:</span><span class="w"> </span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="nt"> maxval</span><span class="p">:</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">}}</span>
</pre></div>
</div>
<p>The following section select the datset used in the BSM contamination and for the SMEFT fit:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="c1">### &#39;Contaminated&#39; datasets ###</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">CMSDY1D12</span><span class="p p-Indicator">,</span><span class="nt"> frac</span><span class="p">:</span><span class="w"> </span><span class="nv">0.75</span><span class="p p-Indicator">,</span><span class="nt"> cfac</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;QCD&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;EWK&#39;</span><span class="p p-Indicator">],</span><span class="nt"> contamination</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;EFT_LO&#39;</span><span class="p p-Indicator">,</span><span class="nt"> simu_fac</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;EFT_LO&quot;</span><span class="p p-Indicator">,}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">CMS_HMDY_13TEV</span><span class="p p-Indicator">,</span><span class="nt"> frac</span><span class="p">:</span><span class="w"> </span><span class="nv">0.75</span><span class="p p-Indicator">,</span><span class="nt"> cfac</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;QCD&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;EWK&#39;</span><span class="p p-Indicator">],</span><span class="nt"> contamination</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;EFT_LO&#39;</span><span class="p p-Indicator">,</span><span class="nt"> simu_fac</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;EFT_LO&quot;</span><span class="p p-Indicator">,}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">ATLASDY2D8TEV</span><span class="p p-Indicator">,</span><span class="nt"> frac</span><span class="p">:</span><span class="w"> </span><span class="nv">0.75</span><span class="p p-Indicator">,</span><span class="nt"> cfac</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;QCDEWK&#39;</span><span class="p p-Indicator">],</span><span class="nt"> contamination</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;EFT_LO&#39;</span><span class="p p-Indicator">,</span><span class="nt"> simu_fac</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;EFT_LO&quot;</span><span class="p p-Indicator">,}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="nv">ATLASZHIGHMASS49FB</span><span class="p p-Indicator">,</span><span class="nt"> frac</span><span class="p">:</span><span class="w"> </span><span class="nv">0.75</span><span class="p p-Indicator">,</span><span class="nt"> cfac</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;QCD&#39;</span><span class="p p-Indicator">],</span><span class="nt"> contamination</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;EFT_LO&#39;</span><span class="p p-Indicator">,</span><span class="nt"> simu_fac</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;EFT_LO&quot;</span><span class="p p-Indicator">,}</span>
</pre></div>
</div>
<p>The fit needs then to be run as a BSM contaminated fit:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>vp-setupfit<span class="w"> </span>runcard.yaml
$<span class="w"> </span>vp-rebuild-data<span class="w"> </span>runcard_folder
$<span class="w"> </span>n3fit<span class="w"> </span>runcard.yaml<span class="w"> </span>replica_number
$<span class="w"> </span>evolven3fit<span class="w"> </span>runcard_folder<span class="w"> </span>replica_number
$<span class="w"> </span>postfit<span class="w"> </span>final_replica_number<span class="w"> </span>runcard_folder
</pre></div>
</div>
<p>Every time a replica is finalized, the output is saved to the <a href="#id1"><span class="problematic" id="id2">`runcard/nnfit/replica_$replica`_</span></a>
folder, which contains a number of files:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">chi2exps.log</span></code>: a json log file with the χ² of the training every 100 epochs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">runcard.exportgrid</span></code>: a file containing the PDF grid.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">runcard.json</span></code>: Includes information about the fit (metadata, parameters, times) in json format.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bsm_fac.csv</span></code>: Contains the values of the EFT coefficients for this replica.</p></li>
</ul>
</div>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="contaminated_fit.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Contaminated fits</p>
      </div>
    </a>
    <a class="right-next"
       href="../datasets.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><strong>Dataset selection</strong></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By PBSP
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023, PBSP.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>